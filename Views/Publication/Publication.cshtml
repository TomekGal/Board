
@model Board.Core.ViewModels.PublicationViewModel


@{
    ViewBag.Title = Model.Heading;

}

<h1>@Model.Heading</h1>

<input asp-for="Publication.Id" type="hidden" />

<form asp-controller="Publication" asp-action="Publication" method="post" enctype="multipart/form-data" class="mt-3">
    <div class="form-group row">
        <label asp-for="Publication.Title" class="col-sm-2 col-form-label"></label>
        <div class="col-sm-10">
            <input class="col-sm-7" asp-for="Publication.Title" placeholder="Tytuł">
            <span asp-validation-for="Publication.Title" class="text-danger"></span>
        </div>
    </div>
    <div class="form-group row">
        <label asp-for="Publication.Content" class="col-sm-2 col-form-label"></label>
        <div class="col-sm-10">
            <textarea rows="7" class="col-sm-7" asp-for="Publication.Content" placeholder="Treść"></textarea>
            <span asp-validation-for="Publication.Content" class="text-danger"></span>
        </div>
    </div>
    <div class="form-group row">
        <label asp-for="Publication.Category" class="col-sm-2 col-form-label"></label>
        <div class="col-sm-10">
            <select class="col-sm-7" asp-for="Publication.CategoryId" asp-items="Model.CategoriesList"></select>
        </div>
    </div>
    <div class="form-group row">
        <label asp-for="Publication.Price" class="col-sm-2 col-form-label"></label>
        <div class="col-sm-10">
            <input class="col-sm-7" asp-for="Publication.Price" placeholder="Cena">
            <span asp-validation-for="Publication.Price" class="text-danger"></span>
        </div>
    </div>
    <div>
        <img class="mb-1" id="image" src="data:image/jpg;base64,@Model.FilesList.ElementAt(0)" alt="Hmm" width="100" height="100" />
    </div>
    <div>

        <input class="col-sm-7" id="filesToUpload" type="file" asp-for="FileModels" multiple accept="image/jpeg,image/png,image/jpg" />
        <input type="hidden" asp-for="FileModels" />
        <@*span asp-validation-for="FileModels" class="text-danger"></span>*@
        <br /><br />

    </div>



    <output class="col-sm-10" id="a"></output>



    <button type="submit" class="btn btn-primary btn-lg mt-2">Zapisz</button>
</form>

 @section Scripts
{
        <script type="text/javascript">


            document.querySelector("#filesToUpload").addEventListener("change", (e) => {
                if (window.File && window.FileReader && window.FileList && window.Blob) {
                    const files = e.target.files;
                    const output = document.querySelector("#a");

                    output.innerHTML = "";
                    for (let i = 0; i < files.length; i++) {
                        if (!files[i].type.match("image")) continue;
                        const imgReader = new FileReader();
                        imgReader.addEventListener("load", function (event) {
                            const imgFile = event.target;
                            const img = document.createElement("img");
                            img.className = "thumbnail"
                            img.src = imgFile.result
                            output.appendChild(img);
                            console.log(img);

                        });
                        imgReader.readAsDataURL(files[i]);

                    }
                } else {
                    alert("Your browser does not support File API");
                }
            });


        </script>

    }
